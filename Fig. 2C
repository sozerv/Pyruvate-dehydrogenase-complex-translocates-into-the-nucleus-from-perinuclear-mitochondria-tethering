//This macro measures the intensity of a protein on the nuclear envelope. Moreover, it can also give you the ratio of the intensity of the protein of interest on the nuclear envelope over the nucleoplasm. It can also save images of the protein of interest on the nuclear envelope and the nucleoplasm in your preffered folder. It is written in ImageJ's native macro language IJ1 macro.
image1=getTitle();	
Dialog.create("What do you want to do?");	
Dialog.addCheckbox("Measure MFN2 on the NE", false);	
Dialog.addCheckbox("Get ratio for MFN2 on the NE over nuclear MFN2", false);	
Dialog.addCheckbox("Create MFN2 image on the NE", false);
Dialog.show();	
choice1=Dialog.getCheckbox();	
choice2=Dialog.getCheckbox();
	choice3=Dialog.getCheckbox();
if (choice1==true) {	
	run("Duplicate...", "duplicate channels=3");
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
run("Enhance Contrast", "saturated=0.35");	
waitForUser("Action Required", "Write down the boxes from montage that you want to analyze");	
Dialog.create("What boxes do you want to keep?");	
Dialog.addNumber("First image", 0);	
Dialog.addNumber("Last image", 0);	
Dialog.show();	
number1=Dialog.getNumber();	
number2=Dialog.getNumber();	
close();	
run("Duplicate...", "duplicate range=number1-number2");	
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
rename("LMNA");	
run("Enhance Contrast", "saturated=0.35");	
run("Gaussian Blur...", "sigma=2");	
setAutoThreshold("Otsu dark");	
run("Convert to Mask");	
run("Fill Holes");	
run("Erode");	
run("Create Selection");	
roiManager("Add");	
roiManager("Select", 0);	
roiManager("Rename", "LMNA");	
selectWindow(image1);	
run("Duplicate...", "duplicate channels=4 slices=number1-number2");	
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
rename("DAPI");	
run("Gaussian Blur...", "sigma=2");	
setAutoThreshold("Otsu dark");	
run("Convert to Mask");	
run("Fill Holes");	
run("Erode");	
run("Erode");	
run("Erode");	
run("Create Selection");	
roiManager("Add");	
roiManager("Select", 1);	
roiManager("Rename", "Nuclei");	
selectWindow("LMNA");	
roiManager("Select", 1);	
setBackgroundColor(0, 0, 0);	
run("Clear", "slice");	
run("Select None");	
run("Create Selection");	
run("Make Inverse");	
roiManager("Add");	
roiManager("Select", 2);	
roiManager("Rename", "NE");	
selectWindow(image1);	
run("Duplicate...", "duplicate channels=2 slices=number1-number2");	
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
run("Enhance Contrast", "saturated=0.35");	
rename(image1);	
roiManager("Select", 2);	
run("Measure");	
roiManager("Deselect");	
roiManager("Delete");	
run("Close All");
print(image1, "First Image - " + number1, "Last Image - " +  number2);	
}	
if (choice2==true) {	
	run("Duplicate...", "duplicate channels=3");
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
run("Enhance Contrast", "saturated=0.35");	
waitForUser("Action Required", "Write down the boxes from montage that you want to analyze");	
Dialog.create("What boxes do you want to keep?");	
Dialog.addNumber("First image", 0);	
Dialog.addNumber("Last image", 0);	
Dialog.show();	
number1=Dialog.getNumber();	
number2=Dialog.getNumber();	
close();	
run("Duplicate...", "duplicate range=number1-number2");	
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
rename("LMNA");	
run("Enhance Contrast", "saturated=0.35");	
run("Gaussian Blur...", "sigma=2");	
setAutoThreshold("Otsu dark");	
run("Convert to Mask");	
run("Fill Holes");	
run("Erode");	
run("Create Selection");	
roiManager("Add");	
roiManager("Select", 0);	
roiManager("Rename", "LMNA");	
selectWindow(image1);	
run("Duplicate...", "duplicate channels=4 slices=number1-number2");	
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
rename("DAPI");	
run("Gaussian Blur...", "sigma=2");	
setAutoThreshold("Otsu dark");	
run("Convert to Mask");	
run("Fill Holes");	
run("Erode");	
run("Erode");	
run("Erode");	
run("Create Selection");	
roiManager("Add");	
roiManager("Select", 1);	
roiManager("Rename", "Nuclei");	
selectWindow("LMNA");	
roiManager("Select", 1);	
setBackgroundColor(0, 0, 0);	
run("Clear", "slice");	
run("Select None");	
run("Create Selection");	
run("Make Inverse");	
roiManager("Add");	
roiManager("Select", 2);	
roiManager("Rename", "NE");	
selectWindow(image1);	
run("Duplicate...", "duplicate channels=2 slices=number1-number2");	
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
run("Enhance Contrast", "saturated=0.35");	
rename(image1);	
roiManager("Select", 2);	
run("Measure");	
roiManager("Select", 1);	
run("Measure");
roiManager("Deselect");	
roiManager("Delete");	
run("Close All");	
print(image1, "First Image - " + number1, "Last Image - " +  number2);
}
if (choice3==true) {	
	run("Duplicate...", "duplicate channels=3");
run("Make Montage...", "columns=7 rows=5 scale=0.25");	
run("Enhance Contrast", "saturated=0.35");	
waitForUser("Action Required", "Write down the boxes from montage that you want to analyze");	
Dialog.create("What boxes do you want to keep?");	
Dialog.addNumber("First image", 0);	
Dialog.addNumber("Last image", 0);	
Dialog.show();	
number1=Dialog.getNumber();	
number2=Dialog.getNumber();	
close();	
run("Duplicate...", "duplicate range=number1-number2");	
run("Make Montage...", "columns=3 rows=2 scale=0.25");	
rename("LMNA");	
run("Enhance Contrast", "saturated=0.35");	
run("Gaussian Blur...", "sigma=2");	
setAutoThreshold("Otsu dark");	
run("Convert to Mask");	
run("Fill Holes");	
run("Erode");	
run("Create Selection");	
roiManager("Add");	
roiManager("Select", 0);	
roiManager("Rename", "LMNA");	
selectWindow(image1);	
run("Duplicate...", "duplicate channels=4 slices=number1-number2");	
run("Make Montage...", "columns=3 rows=2 scale=0.25");	
rename("DAPI");	
run("Gaussian Blur...", "sigma=2");	
setAutoThreshold("Otsu dark");	
run("Convert to Mask");	
run("Fill Holes");	
run("Erode");	
run("Erode");	
run("Erode");	
run("Create Selection");	
roiManager("Add");	
roiManager("Select", 1);	
roiManager("Rename", "Nuclei");	
selectWindow("LMNA");	
roiManager("Select", 1);	
setBackgroundColor(0, 0, 0);	
run("Clear", "slice");	
run("Select None");	
run("Create Selection");	
run("Make Inverse");	
roiManager("Add");	
roiManager("Select", 2);	
roiManager("Rename", "NE");	
selectWindow(image1);	
run("Duplicate...", "duplicate channels=2 slices=number1-number2");	
run("Make Montage...", "columns=3 rows=2 scale=0.25");	
run("Enhance Contrast", "saturated=0.35");	
roiManager("Select", 2);	
run("Clear Outside");	
roiManager("Deselect");	
roiManager("Delete");	
dir=getDirectory("Choose Destination Directory");	
saveAs("Tiff", dir+image1);	
run("Close All");	
}	
